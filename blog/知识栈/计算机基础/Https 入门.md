```yaml
title: Https 入门
author: samin
date: 2021-12-29
```

# 端口为 443

# 数字证书的来源

系统或浏览器预设了很多 CA 根证书（Trusted CA Root Certificate）

## 结构

用户信息 / 用户公钥 / CA 签名

## CA 根证书所在位置

如 Chrome 实在 "设置" -> "高级设置" -> "HTTPS/SSL" -> "管理证书" 

## 浏览器如何验证数字证书的合法性

1. 通过公钥解密数字证书

2. 验证浏览器中 "受信任的根证书颁发机构" 是否存在颁发该SSL证书的机构

3. 验证该网站的 SSL 证书是否过期

4. CRL 验证

# 过程

![https传输过程](https://raw.githubusercontent.com/SaminZou/pic-repo/master/Network/https传输过程-simple.png)

1. 客户端发起Https请求，连接到服务器的443端口

2. 服务器必须要有一套数字证书（证书内容有公钥、证书颁发机构、失效日期等）

3. 服务器将自己的数字证书发送给客户端（公钥在证书里面，私钥由服务器持有）

4. 客户端收到数字证书之后，会验证证书的合法性。如果证书验证通过，就会生成一个随机的对称密钥，用证书的公钥加密

5. 客户端将公钥加密后的密钥发送到服务器

6. 服务器接收到客户端发来的密文密钥之后，用自己之前保留的私钥对其进行非对称解密，解密之后就得到客户端的密钥，然后用客户端密钥对返回数据进行对称加密，这样传输的数据都是密文

7. 服务器将加密后的密文返回到客户端

8. 客户端收到后，用自己的密钥对其进行对称解密，得到服务器返回的数据
