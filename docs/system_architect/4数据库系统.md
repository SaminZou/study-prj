```yaml
title: 数据库系统
author: samin
date: 2021-07-22
```

# 三级模式两级映射

![](./pic/DBMS三级方式两级映射.png)

# 数据库设计过程说明

![](./pic/数据库的设计过程.png)

## 需求分析阶段

需求说明书中包含：

- 数据流图

- 数据字典

- ER模型
通过工具可以选择对应数据库方言生成对应的 DCL SQL 语句

- 关系模式

# E-R 模型

![](./pic/ER模型示例.png)

实体：矩形

椭圆：属性

菱形：联系

![](./pic/ER图绘制方式.png)

推荐用逐步集成方式

![](./pic/ER关系模式.png)

每个实体是一个关系模式，三个以上的组成一个多元联系

答案：C

# 关系代数

- 并

- 交

- 差

- 笛卡尔积

- 投影

- 选择

- 连接

# 规范化理论

## 函数依赖

![](./pic/函数依赖.png)

数据库中函数依赖是指，学号可以确定姓名，但是姓名不能反推学号，也就是所谓的主键

部分依赖指得是组合键

传递函数依赖：A可以确定B，B可以确定C，那么推出A可以确定C

## 价值和用途

非规范化的关系模式，可能存在的问题包括：数据冗余、更新异常、插入异常、删除异常

数据冗余容易导致更新异常（某个数据的更新必须覆盖到所有被冗余应用的记录）

规范化并不一定要做到尽可能高的级别，适当的冗余可能对系统是优化手段

## 求候选关键字

![](./pic/数据库规范化理论的键.png)

超键和候选键的区别就是超键可能存在冗余项

如：学号和姓名组合为超键可以唯一确定性别，去掉多余属性（姓名）去确定性别，称为候选键

候选键和主键的区别在于，主键是唯一存在的

如：学号和身份证号都可以成为候选键，但是不能同时成为主键，选择其中一个成为主键

表之间的关联，需要外键

![](./pic/求候选键.png)

![](./pic/求候选键试题.png)

例1答案：A

例2答案：ABCD

例3答案：B

## 范式 *

范式需要结合函数依赖和求候选键的内容综合起来学习

![](./pic/范式.png)

符合高一级范式的设计，必定符合低一级范式，例如符合 2NF 的关系模式，必定符合 1NF

范式在提供的过程中，规范化级别会越来越高，提高范式的主要手段就是拆分数据表，拆分表的过程中导致系统的性能出现问题，所以一般只需要到达第三范式即可

![](./pic/1NF.png)

字段把高级职称人数进一步变成教授和副教授，就满足了第一范式

![](./pic/2NF.png)

因为 CNO（课程号） 可以确定 CREDIT（学分），所以不满足第二范式，需要单独拆表，去掉 CREDIT，即可满足第二范式

> 没有组合键的情况，满足 1NF 也等于满足 2NF

![](./pic/3NF.png)

去掉 DNAME、LOCATION 两个非主属性传递依赖的时候，就满足第三范式

![](./pic/BCNF.png)

## 范式练习题

![](./pic/范式试题.png)

答案：C、D、A

## 模式分解

![](./pic/模式分解.png)

![](./pic/模式分解试题.png)

两种方法：表格法、公式法（只适用一分为二）

# 数据库并发控制

![](./pic/并发控制.png)

最经典的问题就是银行的转账，设计一方扣钱一方加钱，这是一个事务

数据库的并发控制需要遵循 ACID 原则

![](./pic/并发问题.png)

![](./pic/封锁协议.png)

# 数据库完整性约束

![](./pic/数据库完整性约束.png)

实体完整性约束：主键约束  
参照完整性约束：外键约束  
用户自定义完整性约束：类型、数值大小限制等  

> 提高数据库的数据质量

触发器可以深度定制数据的插入、更新、删除控制

# 数据库安全

![](./pic/数据库安全.png)

审计指 Log 操作日志，可用于问题追踪

# 数据备份

## 从是否停止数据库角度

![](./pic/数据备份.png)

冷备份，速度快，但是过程中不能使用  
热备份，影响性能，不影响使用  
暖备，应用级实现，一般会加锁暂停服务，交互方面较冷备会有对应的提示

## 从备份量的角度

![](./pic/按量备份.png)

差量备份指的是除了第一次完全备份部分的全量备份

## 数据库故障与恢复

![](./pic/数据库故障与恢复.png)

# 分布式数据库

![](./pic/分布式数据库体系结构.png)

以前的集中式数据库是每个银行网点都有自己的数据库，各个银行的数据不相通

![](./pic/分布式数据库各种概念.png)

# 数据库优化

![](./pic/数据库优化.png)

分布式数据库优化 = 局部数据库（集中式数据库）优化 + 全局优化 

# 数据仓库与数据挖掘

BI 的核心技术就是数据仓库和数据挖掘

## 数据仓库

![](./pic/数据仓库.png)

数据仓库的数据来自数据库，数据仓库是面向主题的，数据库面向业务，数据仓库的数据是相对稳定一旦录入就基本不变，可以反应一个时间段的变化

数据集市是数据仓库的过程产物，如从每个部门产生的数据集市集合就是数据仓库

使用数据库仓的数据录入 OLAP 服务器产生有价值的战略数据，这个过程成为数据挖掘

![](./pic/数据挖掘方法分类.png)

# 联邦数据库

![](./pic/联邦数据库.png)

需要区别与分布式数据库

分布式数据库每个节点的表结构和数据库软件都是一样的，同时有一个中心进行统一调配

联邦数据库每个节点的表结构和数据库软件都可以不一样，一般使用接口规范进行协作

# NoSQL 技术

![](./pic/NoSQL技术.png)

NoSQL = Not Only SQL

以前用的数据库基本是 RDBMS

向上扩展指的是升级单台机器的性·能 ，向外扩展指的是增加集群的机器数量

![](./pic/NoSQL特点.png)

# 反规范化技术

![](./pic/反规范化.png)

反规范化也叫逆规范化

规范化的程度越高，表越多，联表查询越难

派生性冗余列，例子：有一个总价字段专门用于记录所有价格的总量

# 大数据基本概念

![](./pic/大数据.png)

大数据可以研究用户的行为习惯用来促进用户消费

![](./pic/大数据和传统数据的区别.png)

