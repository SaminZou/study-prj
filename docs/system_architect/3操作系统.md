```yaml
title: 操作系统
author: samin
date: 2021-07-18
```

# 进程管理

## 进程的状态

![](./pic/进程状态.png)

### 以前的进程状态

- 运行：需要的所有资源和 CPU 资源都有的情况

- 就绪：有需要的所有资源无 CPU 资源

- 等待：缺某种或所有资源（外设交互、用户指令）和 CPU 资源

### 现在的进程状态

程序成熟发展以后，三种进程状态不够用，有人为干预进程状态，提出了五态模型

运行状态不变，活跃就绪对应就绪状态，活跃阻塞对应等待状态，增加了静止就绪和静止阻塞

## 前趋图 * 

和PV操作结合考察

前趋图是用来描述程序行为执行的顺序关系及约束关系

## 进程的同步与互斥

PV操作的分析前提

![](./pic/进程同步与互斥.png)

同步和异步、互斥与共享

同步和互斥没有直接关系

![](./pic/进程同步互斥经典问题.png)

分析清楚同步和互斥点

## PV 操作

- 临界资源：进程间需要互斥方式对其进行共享的资源，如打印机、磁带机等

- 临界区：每个进程中访问临界资源的那段代码成为临界区（是代码段）

- 信号量：是一种特殊的变量 P（S）V（S） ， S 就是信号量

PV操作是两大原子操作的组合

![](./pic/PV操作.png)

信号量不为 0 的时候，开始执行操作 P 是对信号量 -1 ， 一般是为了进入循环等待 V 是对信号量 +1 ， 一般是为了唤醒行为动作

![](./pic/PV用例.png)

P(S1). 生产产品， S1 = S1 - 1 = 0，S1没有小于 0，可以继续执行操作 V(S2). 送产品到缓存区，S2 = S2 + 1 = 1
> 这时候有进程生产产品 S1 = S1 - 1 = -1，S1 小于 0，所以进入等待区 P(S2). 从缓存区取产品，S2 = S2 - 1 = 0，S1 没有小于 0，可以继续执行操作 V(S1). 消费产品，S1 = S1 + 1 = 1
> 如果最开始执行消费者，因为 S2 等于 0，S2 = S2 - 1 = -1，S1 小于 0，进入等待区

![](./pic/PV试题.png)

答案：A、C

1. Sn 的 PV 操作就是为了满足”最多允许n个购书者进入“
2. a1 和 b1 分别是 V(S1)和 P(S1) 操作，代表有人开始付款，唤醒收银动作
3. a2 和 b2 分别是 P(S2)和 V(S2) 操作，代表完成收银动作，继续等待新一轮的付款动作

## PV操作和前趋图结合

![](./pic/前趋图转为PV操作.png)

1. 进行完 V(Sa)、V(Sb)、V(Sc)，代表已经完成绞肉、切葱末和切姜末
2. 搅拌被唤醒，进行 P(Sa)、P(Sb)、P(Sc) 操作（有点像解锁），然后进行 V(Sd)，代表已经完成搅拌
3. 开始最后的包饺子，同时执行 P(Sd)

![](./pic/前趋图转为PV操作试题.png) 

答案：C、A、A