```yaml
title: IoT 平台入门
author: samin
date: 2021-11-17
```

# 实时通讯

物联网平台的实时连接和通信是物联网解决方案和应用的关键需求。这就是我们需要使用消息代理并实现类似发布/订阅机制的地方。消息代理通常是中间件系统，通过发布/订阅机制为所有连接的应用和设备提供异步通信能力。

# 使用MQTT作为消息代理

全称：MQ Telemetry Transport，MQ遥测传输

MQTT有许多商用和开源实现。Mosquitto是Eclipse家族一个流行的开源MQTT实现，我们使用它来构建我们的消息代理。

# 数据存储

## 数据库设计

- ID
  自增主键。我们使用MySQL的自增列功能。

- Topic
  声明为varchar，允许在此字段中存储可变长度的数据。主题的长度可以是任意的，并且根据应用的不同而不同。我们对长度进行1KB的限制，这对于主题名称长度是足够。

- Payload
  数据包可以是任意长度（因此是可变类型）。但我们将有效负载包存储限制为2KB。我们可以在不影响以前存储的数据的情况下增加大小和限制；但当减小长度时，以前的数据可能会被截断。这可以根据需求决定。

- Timestamp
  它是用整数格式表示的UNIX风格的日期时间戳。epoch(或UNIX时间、POSIX时间或UNIX时间戳)是自1970年1月1日以后经过的秒数(不包括闰秒)。

# 通过API访问平台资源

